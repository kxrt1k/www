---
import { getCollection } from "astro:content";

import Section from "../section.astro";
import List from "../list.astro";

const posts = await getCollection("blog");
const sorted = posts.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
const latest = sorted.slice(0, 3);
const normalized = latest.map((post) => ({
  title: post.data.title,
  date: post.data.date.toISOString(),
  url: `/blog/${post.id}`,
}));
---

<Section title="Blog" more={{ label: "view all", url: "/blog" }}>
  <List items={normalized} />
</Section>
